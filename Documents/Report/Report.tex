% Master Thesis Report
% Created by: Claes Arvidson and Emelie Karlsson 
% Linköping University Spring 2016
% First version: 2016-01-27

\documentclass[a4paper, 10pt, twoside, openright]{book}
\pagestyle{headings}

% some of the packages used are
\usepackage[round, authoryear]{natbib}
\bibliographystyle{unsrtnat}
\usepackage{xcolor, colortbl}
\usepackage{tabularx}
\usepackage{latexsym}
\usepackage{eepic}
\usepackage{makeidx}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage[utf8]{inputenc}  %för ä ö å ?
\usepackage[english]{babel}
%\usepackage{times}
\usepackage{amssymb}
%\usepackage{fancybox} 
%\usepackage{textcomp}
\usepackage{float}
%\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{multirow}
\usepackage{footnote}
%\makesavenoteenv{tabular}
%\makesavenoteenv{table}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows}
\usepackage{caption} 
\captionsetup[table]{skip=5pt}

% the fancy header/footer
% consult http://research.cmis.csiro.au/gjw/tex/docs/fancyhdr.pdf
% or some other fancy header documenatation for more info
\usepackage{fancyhdr}
\pagestyle{fancy}
\lfoot{\nouppercase{\rightmark}}
\rfoot{\nouppercase{\leftmark}}
\fancyfoot{} 
\fancyhead[LO]{\nouppercase{\small{\rightmark}}}
\fancyhead[RE]{\nouppercase{\small{\leftmark}}}
\fancyhead[LE,RO]{\small{\thepage}}
\fancyhead[C]{}
\renewcommand{\footrulewidth}{0pt}
\renewcommand{\headrulewidth}{0.2pt}
\fancypagestyle{plain}{ \fancyhf{}  
  \fancyfoot[RE,LO]{\nouppercase{\small{\putegotext}}}
  \fancyfoot[LE,RO]{\small{\thepage}}
  \renewcommand{\headrulewidth}{0pt}  \renewcommand{\footrulewidth}{0.2pt} }

\newcommand\mydots{\hbox to 1em{.\hss.\hss.}}
% ------------------------------------------------------------------------
% BEGINNING of abstract, author, examiner, etc
% here you must fill in your own text. Remember to respect the { and the }.
%
% the *-marked % in 
%                                   *
%      \newcommand{\putabstract}[0]{% 
%      some text}
%
% is made to avoid a blank space in the beginning of the abstract,
% author, date etc.
%
\newcommand{\putabstract}[0]{%
The distribution of tasks to a heterogeneous work force at libraries and other service institutions is time consuming for manual schedulers, but well suited for optimization softwares. The problem studied concerns five types of tasks, two types of worker qualifications and around 100 tasks per week.

During weekends there is a demand for staff members. Also, worker satisfaction is taken into account to avoid unfairness and fatigue.

The main objective is to create a optimal ten week rotating schedule, in which the stand-in staff members are evenly distributed. That results in a robust schedule, as absence of staff members is a common issue.

A mathematical model is formulated for the problem, which is solved using the commercial solver, CPLEX and by using two different large neighbourhood search heuristic implementations. The first heuristic assigns complete week blocks to the staff members, while the second distributes one task at a time. The latter heuristic works better than the former and achieves results comparable to those of the commercial solver. Our conclusion is that the second heuristic works better because it focuses on finding a good weekend distribution, before creating the rest of the schedule.}

\newcommand{\putkeywords}[0]{%
Optimization, Scheduling, Task distribution, LNS, Weekend Scheduling, Heterogeneous workforce}

\newcommand{\putthemonth}[0]{June }

\newcommand{\putshortdate}[0]{2016}

\newcommand{\putmydate}[0]{\putthemonth \putshortdate}

\newcommand{\putauthor}[0]{Claes Arvidson and Emelie Karlsson}

\newcommand{\putegotext}[0]{Arvidson, Karlsson, 2016.}

\newcommand{\puttitle}[0]{Work Distribution for a Heterogeneous Library Staff - \\  A Personnel Task Scheduling Problem}

% some kind of administrator will give you this number
\newcommand{\putregnumber}[0]{LiTH - MAT - EX - - 04 / 04 - - SE}

\newcommand{\putexaminer}[0]{Elina Rönnberg}

\newcommand{\putsupervisor}[0]{Torbjörn Larsson}

% for example Applied Mathematics
\newcommand{\putdepartment}[0]{Optimeringslära}

% send an email to ep.liu.se to make sure it is correct before you print
% this number is the one I had
\newcommand{\putmyurl}[0]{http://www.ep.liu.se/exjobb/mai/2004/tm/004/}

% Please do not change into University of Linköping or something, the
% international name of Liu is Linköpings Universitet
\newcommand{\putliu}[0]{Linköpings Universitet}

%Create the command \tab
\newcommand{\tab}[1]{\hspace{.25\textwidth}\rlap{#1}}
\newcommand{\itab}[1]{\hspace{0em}\rlap{#1}}
\DeclarePairedDelimiter\abs{\lvert}{\rvert}
\DeclarePairedDelimiter\norm{\lVert}{\rVert}
%
% END of abstract, author, examiner, etc
% ------------------------------------------------------------------------

\begin{document} 

\frontmatter
\raggedbottom
% some new commands I used, you won't need them I guess- just erase it
\newcommand{\ala}[0]{{\alpha}_{1}}
\newcommand{\alb}[0]{{\alpha}_{2}}
\newcommand{\nc}[0]{{N}_{C}}
\newcommand{\tCh}[0]{the Chemostat }
\newcommand{\Ch}[0]{Chemostat }
\newcommand{\ch}[0]{chemostat }
\newcommand{\MMk}[0]{Michaelis-Menten kinetics }
\newcommand{\KI}[0]{{K}_{I} }
\newcommand{\KN}[0]{{K}_{N} }
\newcommand{\mmu}[0]{{\mu}_{max} }
\newcommand{\KMAX}[0]{\mmu}
\newcommand{\AAA}[0]{\mathbf{A} }
% stop erasing here

%\usepackage[first=0,last=9]{lcg}
%\newcommand{\ra}{\rand0.\arabic{rand}}

% Colors
\newcommand{\enc}[0]{utf8}
\definecolor{bluegray}{rgb}{0.4, 0.6, 0.8}
\definecolor{darkcyan}{rgb}{0.0, 0.55, 0.55}
\definecolor{corn}{rgb}{0.98, 0.93, 0.36}
\definecolor{coralred}{rgb}{1.0, 0.25, 0.25}
\definecolor{Gray}{gray}{0.85}
\definecolor{Darkgray}{gray}{0.9}
\definecolor{maroon}{cmyk}{0,0.87,0.68,0.32}
\newcommand{\colcell}{\cellcolor{Gray}}
\newcommand{\colcelltwo}{\cellcolor{corn}}
\newcommand{\colcellthree}{\cellcolor{darkcyan}}
\newcolumntype{g}{>{\columncolor{corn}}c}

% Special cells
\newcommand{\specialcell}[2][c]{%
  \begin{tabular}[#1]{@{}l@{}}#2\end{tabular}}
\newcommand{\specialcelltwo}[2][c]{%
   \begin{tabular}[#1]{@{}l@{}l@{}}#2\end{tabular}}
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

\makeatletter% Set distance from top of page to first float
\setlength{\@fptop}{5pt}
\makeatother


% don't mind these
\title{\puttitle}
\author{\putauthor}

% this command makes the first page, and the second page, handle with care
% You really don't have to change anything here I guess.
\renewcommand{\maketitle}{%
              \newpage%
              \pagestyle{empty}
              \null%
              \hfil\hspace*{-3mm}
              \begin{minipage}{150mm}
                \center 
                {\Large{Master thesis}} \\\vspace*{4mm}
                {\vbox to 22mm{\vfil\Large\textbf{\puttitle}}}
                \vspace*{5mm}
                 {\Large{\putauthor}}       \\ \vspace*{4mm}
                  \putregnumber\\
                \end{minipage}\hfil
              \clearpage%\hspace*{0mm}\thispagestyle{empty}
              \clearpage%\thispagestyle{empty}
              \null%
              \hfil\hspace*{-3mm}
              \begin{minipage}{150mm}
                \center
                {\vbox to 48mm{\vfil\Large\textbf{\puttitle}}}
                \vspace*{5mm}
                  \putdepartment, \putliu \\ \vspace*{4mm}
                  \textbf{\putauthor}       \\ \vspace*{4mm}
                  \putregnumber
                  \vspace*{100mm}\\
                \flushleft
                
                Exam work:\hspace*{3pt}
                \begin{minipage}[t]{70mm}
% but you might want to change this 30
                  \textbf{30 hp}
                \end{minipage} \\ \vspace*{4mm}
                
                Level:\hspace*{3pt}
                \begin{minipage}[t]{70mm}
% and you might want to change this A 
                  \textbf{A} 
                \end{minipage} \\ \vspace*{4mm}
                
                Supervisor:\hspace*{3pt}
                \begin{minipage}[t]{120mm}
                  \textbf{\putsupervisor}, \\\putdepartment, \putliu
                \end{minipage} \\ \vspace*{4mm}
                
                Examiner:\hspace*{3pt}
                \begin{minipage}[t]{120mm}
                  \textbf{\putexaminer}, \\\putdepartment, \putliu
                \end{minipage} \\ \vspace*{4mm}
                
                Linköping:
                \begin{minipage}[t]{70mm}
                  \textbf{\putmydate}
                \end{minipage} \\ \vspace*{4mm}
              \end{minipage} \\ \hfill
}

% now the \maketitle command is changed and we use the new one
\maketitle

% I'm not sure this phantom is needed, but I leave to make sure
% a phantom leaves empty space corresponding to the size of what is in it.
\phantom{crap}
\thispagestyle{empty}
\pagestyle{empty}

\setlength{\unitlength}{1mm}


\setlength{\unitlength}{1pt}

% now turn on fancy headers
\pagestyle{fancy}

% ..................chapter ...............................................
\chapter*{Abstract\index{Abstract}}
% your abstract
\putabstract

% enters keywords
\begin{description}
\item[Keywords:]{%
\putkeywords
}
\item[URL for electronic version: ]{\hfill%\quad\\%
%\phantom{\qquad} http://urn.kb.se/resolve?urn=urn:nbn:se:liu:diva-77777\\
%where 77777 should be replacd by an appropriate number.
\begin{center}
http://urn.kb.se/resolve?urn=urn:nbn:se:liu:diva-77777
\end{center}
%where 77777 should be replaced by an appropriate number.
}
\end{description}


% here or on the next page you put an abstract in swedish
%\section*{Abstract in Swedish: Sammanfattning}
%Det finns många typer av bioreaktorer som tillämpas\ldots

\chapter*{Acknowledgements\index{Acknowledgements}}

We would like to express our deepest gratitude to our supervisor, Torbjörn Larsson, at Linköping University, who has helped us find our way in moments of uncertainty and who has been guiding us through the whole project. Thank you for the time and effort you have spent on our thesis. We would also like to thank our examiner, Elina Rönnberg, who has provided encouraging words and valuable insights throughout the project.

Furthermore, we would like to thank Elisabeth Cserhalmi and Ingrid Loeld  Rasch at Norrköpings Stadsbibliotek for providing us with an interesting thesis topic and for answering all our questions many times over.

We thank our opponents, Akdas Hossain and Emma Miléus, for their comments and thoughts on this report.

Lastly, we would like to thank our families and loved ones, who have supported us until the end. 



% optional I guess
\chapter*{Nomenclature\index{Nomenclature}}

The most reoccurring terms and abbreviations are described here.

%----------------NEW_SECTION--------------------------------------------------
\section*{Optimization terms\index{Optimization terms}}
\begin{tabular}{lp{10cm}}

Heuristic & An algorithm designed to find feasible, but not necessarily optimal, solutions. \\
Large neighbourhood search & Optimization method which alternately destroys and respairs the solution in order to move through the solution space. \\
Simulated annealing & Optimization method which allows for the acceptance of deteriorating solutions with a certain probability. The probability decreases with time. \\
%Rostering & \\
%Matheuristic & Text\\
\end{tabular}

\section*{Library related terms\index{Library terms}}
\begin{tabular}{lp{10cm}}

Fetch list & The library task of collecting books from shelves, to be delivered elsewhere. \\
Library on wheels & The task of driving a library bus with books to remote areas of town. \\
Outer task & The tasks which are directed towards the visitors for which there is a need for scheduling. \\
Inner task & The tasks which are not outer tasks are inner tasks. These include less visible work such as answering emails. \\
Week rest & The period of rest granted to a worker after weekend work. This normally includes one or two extra days off. \\
%Rostering & \\
%Matheuristic & Text\\
\end{tabular}

%\begin{tabular}{ll}
%$Y_0$      & The amount of the variable $Y$ inserted into a system.\\
%$\hat Y$& The unit-dimension of the variable $Y$, for example $\hat t=1s$ .\\
%$\bar Y_i$ & A steady state (number $i$) value of Y.\\
%\phantom{a}& \phantom{b} \\
%$K_i$ & Constants used in kinetic expressions, for example $K_I$.\\
%\phantom{a}& \phantom{b} \\
%$\AAA$     & The system matrix. \\
%\end{tabular}

\section*{Abbreviations\index{Abbreviations}}

\begin{tabular}{ll}
LNS		& Large neighbourhood search \\
SA		& Simulated annealing \\
Exp		& Service counter (sv. expeditionsdisken) \\
Info	& Information counter (sv. informationsdisken)\\
PL		& Fetch list (sv. plocklistan)\\
BokB    & Library on wheels (sv. bokbussen)\\
HB      & Hageby library \\
\end{tabular}


\tableofcontents 
\begin{samepage}
\listoffigures
\let\clearpage\relax
\listoftables
\end{samepage}


\mainmatter

%##########################################################
% -------------------CHAPTERS -----------------------------
%##########################################################

\chapter{Introduction}\label{chap:intro}

\inputencoding{\enc}
\input{Chapters/Introduction}
\inputencoding{\enc}

\chapter{Literature review}\label{chap:lit}

\inputencoding{\enc}
\input{Chapters/LiteratureReview}
\inputencoding{\enc}

\chapter{The mathematical model}\label{chap:mathmod}

\inputencoding{\enc}
\input{Chapters/MathModel}
\inputencoding{\enc}

%\chapter{Two heuristics}\label{chap:heur}
%
%\inputencoding{\enc}
%\input{Chapters/Implementation}
%\inputencoding{\enc}

\chapter{Two heuristic solution methods}\label{chap:heur}

\inputencoding{\enc}
\input{Chapters/Heuristics}
\inputencoding{\enc}

%\chapter{Task distribution approach}\label{chap:taskdist}
%
%\inputencoding{\enc}
%\input{Chapters/TaskDistributionApproach.tex}
%\inputencoding{\enc}

\chapter{Results and discussion}\label{chap:res}
\inputencoding{\enc}
\input{Chapters/ResultsAndDiscussion.tex}
\inputencoding{\enc}

%\chapter{Further development}\label{chap:further}
%\inputencoding{\enc}
%\input{Chapters/FurtherDevelopment.tex}
%\inputencoding{\enc}

\chapter{Concluding remarks}\label{chap:concl}
\inputencoding{\enc}
\input{Chapters/Conclusion.tex}
\inputencoding{\enc}


%##########################################################
% -------------------END CHAPTERS -------------------------
%##########################################################

\bibliography{Chapters/References}


%%% .................. appendix ...................................
\appendix
\chapter{Problem definitions} \label{appendix:mathmod}
\inputencoding{\enc}
\input{Chapters/ModelAppendix.tex}
\inputencoding{\enc}


\chapter{Week block table} \label{appendix:weekblock}
\begin{table}[!h]
\centering
\caption{Number of assignable unique blocks for the workers based on their availability and qualification.}
\label{blocks_available_per_worker}
\scalebox{0.75}{
	\begin{tabular}{|c|ccc|}
	\hline
	Worker & Weekend & Weekrest & Weekday \\ \hline
	1      & 532     & 347      & 1580    \\ \hline
	2      & 1580    & 1580     & 1580    \\ \hline
	3      & 1063    & 347      & 1580    \\ \hline
	4      & 557     & 165      & 779     \\ \hline
	5      & 261     & 130      & 531     \\ \hline
	6      & 532     & 130      & 1580    \\ \hline
	7      & 261     & 130      & 531     \\ \hline
	8      & 261     & 29       & 531     \\ \hline
	9      & 115     & 12       & 247     \\ \hline
	10     & 532     & 130      & 1580    \\ \hline
	11     & 9       & 8        & 8       \\ \hline
	12     & 1063    & 347      & 1580    \\ \hline
	13     & 771     & 92       & 1190    \\ \hline
	14     & 265     & 29       & 489     \\ \hline
	15     & 51      & 18       & 120     \\ \hline
	16     & 495     & 130      & 843     \\ \hline
	17     & 237     & 69       & 267     \\ \hline
	18     & 532     & 279      & 1580    \\ \hline
	19     & 495     & 47       & 843     \\ \hline
	20     & 532     & 130      & 1580    \\ \hline
	21     & 227     & 227      & 227     \\ \hline
	22     & 2       & 1        & 1       \\ \hline
	23     & 3       & 2        & 2       \\ \hline
	24     & 11      & 5        & 47      \\ \hline
	25     & 1063    & 279      & 1580    \\ \hline
	26     & 5       & 4        & 4       \\ \hline
	27     & 213     & 106      & 425     \\ \hline
	28     & 2       & 2        & 2       \\ \hline
	29     & 426     & 106      & 1281    \\ \hline
	30     & 127     & 126      & 455     \\ \hline
	31     & 495     & 130      & 843     \\ \hline
	32     & 261     & 29       & 531     \\ \hline
	33     & 72      & 45       & 306     \\ \hline
	34     & 425     & 425      & 425     \\ \hline
	35     & 91      & 20       & 221     \\ \hline
	36     & 55      & 27       & 101     \\ \hline
	37     & 1063    & 347      & 1580    \\ \hline
	38     & 3       & 1        & 1       \\ \hline
	39     & 2       & 1        & 1       \\ \hline
	\end{tabular}
	}
\end{table}

% this is the copyright page, I did not touch it much.

\cleardoublepage

\thispagestyle{plain}

\begin{picture}(20,20)(0,0)
% \put(0,10){\includegraphics[width=3.5cm]{epresslogo}}
\put(280,0){\includegraphics[width=2.5cm]{univlogo.eps}}
\end{picture}
 
\null
\vspace{0cm} 

Copyright
\medskip

The publishers will keep this document online on the Internet - or its possible replacement - for a period of 25 years from the date of publication barring exceptional circumstances.
The online availability of the document implies a permanent permission for anyone to read, to download, to print out single copies for your own use and to use it unchanged for any non-commercial research and educational purpose. Subsequent transfers of copyright cannot revoke this permission. All other uses of the document are conditional on the consent of the copyright owner. The publisher has taken technical and administrative measures to assure authenticity, security and accessibility.
According to intellectual property law the author has the right to be mentioned when his/her work is accessed as described above and to be protected against infringement.
For additional information about the Linköping University Electronic Press and its procedures for publication and for assurance of document integrity, please refer to its WWW home page: http://www.ep.liu.se/
\bigskip

Upphovsr\"att
\medskip

Detta dokument hålls tillgängligt på Internet - eller dess framtida ersättare - under 25 år från publiceringsdatum under förutsättning att inga extraordi\-nära omständigheter uppstår.
Tillgång till dokumentet innebär tillstånd för var och en att läsa, ladda ner, skriva ut enstaka kopior för enskilt bruk och att använda det oförändrat för ickekommersiell forskning och för undervisning. Överföring av upphovsrätten vid en senare tidpunkt kan inte upphäva detta tillstånd. All annan användning av dokumentet kräver upphovsmannens medgivande. För att garantera äktheten, säkerheten och tillgängligheten finns det lösningar av teknisk och administrativ art.
Upphovsmannens ideella rätt innefattar rätt att bli nämnd som upphovsman i den omfattning som god sed kräver vid användning av dokumentet på ovan beskrivna sätt samt skydd mot att dokumentet ändras eller presenteras i sådan form eller i sådant sammanhang som är kränkande för upphovsmannens litterära eller konstnärliga anseende eller egenart.
För ytterligare information om Linköping University Electronic Press se förlagets hemsida http://www.ep.liu.se/

\medskip

\copyright\phantom{.} \putshortdate, \putauthor




%----------------END OF DOCUMENT----------------------------------------------
%----------------END OF DOCUMENT----------------------------------------------

\end{document}
 
